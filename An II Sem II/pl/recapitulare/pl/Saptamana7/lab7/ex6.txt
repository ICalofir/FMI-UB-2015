fmod LIST-INT3 is
	protecting INT .
	sort List .
	subsort Int < List .
	op nil : -> List .
	op _ _ : List List -> List [assoc id: nil] .
endfm

fmod LENGTH is
	protecting LIST-INT3 .
	op length : List -> Nat .
	op _in_ : Int List -> Bool .
	op append : List List -> List .
	op rev : List -> List .
	op sort : List -> List .
	op insert : Int List -> List .

	var I H : Int .
	var L L1 L2 : List .

	eq length(nil) = 0 .
	eq length(I L) = 1 + length(L) .

	eq I in nil = false .
	eq I in H L = I == H or I in L .

	eq append(nil, L2) = L2 .
	eq append(H L1, L2) = H append(L1, L2) .

	eq rev(nil) = nil .
	eq rev(H L) = append(rev(L), H) .

	eq insert(I, nil) = I .
	eq insert(I, H L) = if I <= H then I H L
			else H insert(I, L) fi .

	eq sort(nil) = nil .
	eq sort(H L) = insert(H, sort(L)) .
endfm
